(window["webpackJsonpfhir-death-refactor"]=window["webpackJsonpfhir-death-refactor"]||[]).push([[0],{229:function(e,t,n){e.exports=n(414)},230:function(e,t,n){n(231)},282:function(e,t,n){},414:function(e,t,n){"use strict";n.r(t);n(230);var a=n(0),r=n.n(a),i=n(33),o=n.n(i),c=n(24),l=n.n(c),s=(n(281),n(282),n(44));var u=function(e){return r.a.createElement(s.a,{className:"loading",name:"circle notched",loading:!0,size:"huge"})},d=n(26),h=n(6),f=n(13),p=n(10),m=n(9),y=n(20),b=n(11),v=n(433),g=n(25),O=n.n(g),j=n(432);var E=function(e){return r.a.createElement(j.a,{color:"blue",inverted:!0,attached:!0},r.a.createElement(j.a.Item,{header:!0},r.a.createElement("h2",null,"U.S. Standard Certificate of Death")),r.a.createElement(j.a.Item,{name:"about",position:"right"}))},D=n(429),C=n(427),S=n(428);var w=function(e){var t=e.patient;return t?r.a.createElement(D.a,{fluid:!0,color:"blue",className:"patient"},r.a.createElement(C.a,{className:"patient-info-table"},r.a.createElement(C.a.Body,null,r.a.createElement(C.a.Row,{textAlign:"center"},t.name&&r.a.createElement(C.a.Cell,null,r.a.createElement(S.a.Item,null,r.a.createElement(S.a.Content,null,r.a.createElement(S.a.Header,{className:"patient-info-header"},r.a.createElement(s.a,{color:"blue",name:"user"}),r.a.createElement("span",{className:"patient-info-header-text"},"Name")),t.name))),t.birthDate&&r.a.createElement(C.a.Cell,null,r.a.createElement(S.a.Item,null,r.a.createElement(S.a.Content,null,r.a.createElement(S.a.Header,{className:"patient-info-header"},r.a.createElement(s.a,{color:"blue",name:"birthday"}),r.a.createElement("span",{className:"patient-info-header-text"},"Birthdate")),t.birthDate))),t.age&&r.a.createElement(C.a.Cell,null,r.a.createElement(S.a.Item,null,r.a.createElement(S.a.Content,null,r.a.createElement(S.a.Header,{className:"patient-info-header"},r.a.createElement(s.a,{color:"blue",name:"calendar"}),r.a.createElement("span",{className:"patient-info-header-text"},"Age at Death")),t.age," old"))),t.race&&r.a.createElement(C.a.Cell,null,r.a.createElement(S.a.Item,null,r.a.createElement(S.a.Content,null,r.a.createElement(S.a.Header,{className:"patient-info-header"},r.a.createElement(s.a,{color:"blue",name:"users"}),r.a.createElement("span",{className:"patient-info-header-text"},"Race and Ethnicity")),t.race,t.ethnicity&&", "+t.ethnicity))),t.gender&&r.a.createElement(C.a.Cell,null,r.a.createElement(S.a.Item,null,r.a.createElement(S.a.Content,null,r.a.createElement(S.a.Header,{className:"patient-info-header"},r.a.createElement(s.a,{color:"blue",name:"female"===t.gender?"woman":"male"===t.gender&&"man"}),r.a.createElement("span",{className:"patient-info-header-text"},"Gender")),t.gender))),t.address&&r.a.createElement(C.a.Cell,null,r.a.createElement(S.a.Item,null,r.a.createElement(S.a.Content,null,r.a.createElement(S.a.Header,{className:"patient-info-header"},r.a.createElement(s.a,{color:"blue",name:"point"}),r.a.createElement("span",{className:"patient-info-header-text"},"Address")),t.address))))))):null},R=function(){function e(t){Object(h.a)(this,e),this.resource=t}return Object(f.a)(e,[{key:"id",get:function(){return this.resource&&this.resource.id||null}},{key:"name",get:function(){if(this.resource&&this.resource.name){var e=l.a.isArray(this.resource.name)?this.resource.name[0]:this.resource.name,t=[],n=(t=(t=(t=t.concat(e.given)).concat(e.family)).concat(e.suffix)).join(" ").trim();if(n.length>0)return n}return null}},{key:"age",get:function(){if(this.resource){var e=this.resource.birthDate,t=this.resource.deceasedDateTime||(new Date).toISOString();return e?O()(t).diff(O()(e),"years")+" years":null}return null}},{key:"deceasedDate",get:function(){return this.resource&&this.resource.deceasedDateTime?O()(this.resource.deceasedDateTime).format("YYYY-MM-DD"):null}},{key:"deceasedTime",get:function(){return this.resource&&this.resource.deceasedDateTime?O()(this.resource.deceasedDateTime).format("HH:mm"):null}},{key:"ssn",get:function(){if(this.resource&&this.resource.identifier&&this.resource.identifier.length>0){var e=this.resource.identifier.find((function(e){return"http://hl7.org/fhir/sid/us-ssn"===e.system}));return e?e.value:null}return null}},{key:"race",get:function(){if(this.resource&&this.resource.extension&&this.resource.extension.length>0){var e=this.resource.extension.find((function(e){return"http://hl7.org/fhir/StructureDefinition/us-core-race"===e.url||"http://hl7.org/fhir/us/core/StructureDefinition/us-core-race"===e.url}));return e&&e.valueCodeableConcept&&e.valueCodeableConcept.coding[0]&&e.valueCodeableConcept.coding[0].display?e.valueCodeableConcept.coding[0].display:null}return null}},{key:"ethnicity",get:function(){if(this.resource&&this.resource.extension&&this.resource.extension.length>0){var e=this.resource.extension.find((function(e){return"http://hl7.org/fhir/StructureDefinition/us-core-ethnicity"===e.url||"http://hl7.org/fhir/us/core/StructureDefinition/us-core-ethnicity"===e.url}));return e&&e.valueCodeableConcept&&e.valueCodeableConcept.coding[0]&&e.valueCodeableConcept.coding[0].display?e.valueCodeableConcept.coding[0].display:null}return null}},{key:"birthPlace",get:function(){if(this.resource&&this.resource.extension&&this.resource.extension.length>0){var e=this.resource.extension.find((function(e){return"http://standardhealthrecord.org/fhir/extensions/placeOfBirth"===e.url||"http://hl7.org/fhir/StructureDefinition/birthPlace"===e.url}));if(e&&e.valueAddress){var t="".concat(e.valueAddress.city||""," ").concat(e.valueAddress.state||"");return(t=t.replace(/\s/g,"")).length>0?t:null}return null}return null}},{key:"mothersMaidenName",get:function(){if(this.resource&&this.resource.extension&&this.resource.extension.length>0){var e=this.resource.extension.find((function(e){return"http://hl7.org/fhir/StructureDefinition/patient-mothersMaidenName"===e.url}));return e?e.valueString:null}return null}},{key:"gender",get:function(){return this.resource&&this.resource.gender||null}},{key:"birthDate",get:function(){return this.resource&&this.resource.birthDate||null}},{key:"deathDateTime",get:function(){if(this.resource){var e=this.resource.deceasedDateTime||(new Date).toISOString();return O()(e).format("YYYY-MM-DD hh:mm")}return null}},{key:"address",get:function(){if(this.resource&&this.resource.address){var e=this.resource.address[0];return e?"".concat(e.line?e.line:""," ").concat(e.city?e.city:""," ").concat(e.district?e.district:""," ").concat(e.state?e.state:""," ").concat(e.postalCode?e.postalCode:"").replace(/\s+/g," "):null}return null}},{key:"maritalStatus",get:function(){if(!this.resource)return null;var e=this.resource.maritalStatus;if(!(e&&e.coding[0]&&e.coding[0].code))return null;switch(e.coding[0].code){case"A":return"Annulled";case"D":return"Divorced";case"I":return"Interlocutory";case"L":return"Legally";case"M":return"Married";case"P":return"Polygamous";case"S":return"Never Married";case"T":return"Domestic partner";case"U":return"Unmarried";case"W":return"Widowed";default:return"Unknown"}}}]),e}(),P=function(){function e(t){Object(h.a)(this,e),this.resource=t}return Object(f.a)(e,[{key:"id",get:function(){return this.resource.id}},{key:"name",get:function(){if(this.resource&&this.resource.name){var e=l.a.isArray(this.resource.name)?this.resource.name[0]:this.resource.name,t=[],n=(t=(t=(t=t.concat(e.given)).concat(e.family)).concat(e.suffix)).join(" ").trim();if(n.length>0)return n}return null}},{key:"street",get:function(){return this.resource.address&&this.resource.address[0]&&this.resource.address[0].line[0]?this.resource.address[0].line[0]:null}},{key:"city",get:function(){return this.resource.address&&this.resource.address[0]?this.resource.address[0].city:null}},{key:"county",get:function(){return this.resource.address&&this.resource.address[0]?this.resource.address[0].district:null}},{key:"state",get:function(){return this.resource.address&&this.resource.address[0]?this.resource.address[0].state:null}},{key:"zip",get:function(){return this.resource.address&&this.resource.address[0]?this.resource.address[0].postalCode:null}}]),e}();function k(e){if(e)return O()(e).format("MMMM Do YYYY")}var x=function(){function e(t){Object(h.a)(this,e),this.resource=t}return Object(f.a)(e,[{key:"withEmbeddedResource",value:function(t,n){var a=this;if(this.resource[t]&&this.resource[t].reference){var r=this.resource[t].reference.split("/").reverse()[1],i=this.resource[t].reference.split("/").reverse()[0];return n.api.read({type:r,id:i}).then((function(n){return a[t]=e.wrap(n.data),a}))}return Promise.resolve(this)}},{key:"id",get:function(){return this.resource.id}},{key:"description",get:function(){return this.resource.code&&this.resource.code.text?this.resource.code.text:this.resource.code&&this.resource.code.coding&&this.resource.code.coding[0].display?this.resource.code.coding[0].display:null}},{key:"formattedStartDate",get:function(){return k(this.startDate)}},{key:"formattedEndDate",get:function(){return k(this.endDate)}},{key:"formattedDateRange",get:function(){return this.formattedStartDate&&this.formattedEndDate&&this.formattedStartDate!==this.formattedEndDate?"".concat(this.formattedStartDate," through ").concat(this.formattedEndDate):this.startDate?this.formattedStartDate:null}}],[{key:"wrap",value:function(t){switch(t.resourceType){case"Condition":return new I(t);case"Procedure":return new T(t);case"Observation":return new A(t);case"MedicationRequest":return new N(t);case"MedicationOrder":return new F(t);case"Practitioner":return new P(t);default:return new e(t)}}}]),e}(),I=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(f.a)(t,[{key:"startDate",get:function(){return this.resource.onsetDateTime}},{key:"endDate",get:function(){return this.resource.abatementDateTime}}]),t}(x),T=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(f.a)(t,[{key:"startDate",get:function(){return this.resource.performedDateTime||this.resource.performedPeriod.start}},{key:"endDate",get:function(){return this.resource.performedPeriod?this.resource.performedPeriod.end:null}},{key:"additionalText",get:function(){return this.resource.reasonReference&&this.resource.reasonReference[0]&&this.resource.reasonReference[0].display?"Reason: ".concat(this.resource.reasonReference[0].display):null}}]),t}(x),A=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(f.a)(t,[{key:"startDate",get:function(){return this.resource.effectiveDateTime}},{key:"endDate",get:function(){return this.resource.effectiveDateTime}},{key:"additionalText",get:function(){return this.resource.valueQuantity&&this.resource.valueQuantity.value?"Value: ".concat(this.resource.valueQuantity.value," ").concat(this.resource.valueQuantity.unit):null}}]),t}(x),N=function(e){function t(e){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Object(h.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).medicationResource=a,n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"description",get:function(){return this.medicationReference?this.medicationReference.description:this.resource.medicationCodeableConcept&&this.resource.medicationCodeableConcept.coding?this.resource.medicationCodeableConcept.coding[0].display:null}},{key:"startDate",get:function(){return this.resource.dateWritten||this.resource.authoredOn}},{key:"endDate",get:function(){return this.resource.dateWritten||this.resource.authoredOn}}]),t}(x),F=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(f.a)(t,[{key:"description",get:function(){return this.medicationReference?this.medicationReference.description:this.resource.medicationCodeableConcept&&this.resource.medicationCodeableConcept.coding?this.resource.medicationCodeableConcept.coding[0].display:null}},{key:"startDate",get:function(){return this.resource.dateWritten||this.resource.authoredOn}},{key:"endDate",get:function(){return this.resource.dateWritten||this.resource.authoredOn}}]),t}(x),M=x,H=(n(389),window.FHIR),V=function(){return new Promise((function(e){H.oauth2.ready((function(t){e(t)}))}))},U=function(e,t){var n={type:"Patient"};return t&&(n.query=t),e.api.search(n).then((function(e){return e.data&&e.data.entry?e.data.entry.map((function(e){return new R(e.resource)})):[]}))},Y=function(e,t){var n,a=function(n){return new Promise((function(a){return e.api.search({type:n,query:{patient:t}}).then((function(e){if(l.a.isUndefined(e.data.total)&&e.data.entry||l.a.isNumber(e.data.total)&&e.data.total>0&&e.data.entry){var t=e.data.entry.map((function(e){return M.wrap(e.resource)}));a(l.a.sortBy(t,(function(e){return O()(e.startDate)})).reverse())}else a([])}),(function(e){a([])}))}))},r=function(t){return Promise.all(t.map((function(t){return t.withEmbeddedResource("medicationReference",e)})))};return Promise.all([a("Condition"),(n=[a("MedicationRequest").then(r),a("MedicationOrder").then((function(t){return Promise.all(t.map((function(t){return t.withEmbeddedResource("prescriber",e)})))})).then(r)],new Promise((function(e){Promise.all(n).then((function(t){var n=!0,a=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value;c.length>0&&e(c)}}catch(l){a=!0,r=l}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}e([])}))}))),a("Procedure"),a("Observation")])},L=function(e,t){var n=H.client({serviceUrl:e});return U(n,t)},B=function(e,t){var n=H.client({serviceUrl:e});return Y(n,t)},W=function(){return V()},G=function(e){H.oauth2.authorize(e)},q=function(e){return V().then((function(t){return U(t,e)}))},Z=function(e){return V().then((function(t){return Y(t,e)}))},Q=function(){return V().then((function(e){var t=e.user.read(),n=e.patient.read(),a=B(e.server.serviceUrl,e.patient.id);return Promise.all([t,n,a]).then((function(e){var t=Object(d.a)(e,3),n=t[0],a=t[1],r=t[2];return a=new R(a),[n=new P(n),a].concat(r)}))}))},z=n(66),J=n(423),_=n(425),$=n(415),K={retrieveState:function(e,t){var n=localStorage[e];return n?Object.assign({},t,JSON.parse(n)):t},storeState:function(e,t){localStorage[e]=JSON.stringify(t)}},X=function(e){function t(e){var n;Object(h.a)(this,t),n=Object(p.a)(this,Object(m.a)(t).call(this,e));var a=K.retrieveState("statePatientSearch",{name:"",given:"",family:""});return n.state=Object.assign({},a,{searching:!1}),n.handleChange=n.handleChange.bind(Object(y.a)(n)),n.handleFhirServerChange=n.handleFhirServerChange.bind(Object(y.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(y.a)(n)),n.handlePatientClick=n.handlePatientClick.bind(Object(y.a)(n)),n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"handleChange",value:function(e){var t=this,n=e.target;this.setState(Object(z.a)({},n.name,n.value),(function(){K.storeState("statePatientSearch",l.a.pick(t.state,["name","given","family"]))}))}},{key:"handleFhirServerChange",value:function(e){this.props.updateFhirServer(e.target.value)}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.setState({patients:[],searching:!0});var n={};this.state.name.length>0&&(n.name=this.state.name),this.state.given.length>0&&(n.given=this.state.given),this.state.family.length>0&&(n.family=this.state.family),this.props.smart?q(n).then((function(e){t.setState({patients:e,searching:!1})})):L(this.props.fhirServer,n).then((function(e){t.setState({patients:e,searching:!1})}))}},{key:"handlePatientClick",value:function(e,t){e.preventDefault();var n=this.state.patients.find((function(e){return e.id===t.id}));this.props.handlePatientSelect(n)}},{key:"render",value:function(){var e,t=this,n=function(e){return r.a.createElement(D.a,{key:e.id,onClick:t.handlePatientClick,id:e.id,header:e.name})},a=r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"FHIR server:"),r.a.createElement("input",{type:"text",name:"fhirServer",value:this.props.fhirServer,onChange:this.handleFhirServerChange}));return r.a.createElement("div",null,r.a.createElement("h3",null,"Specify ",this.props.smart?"":"FHIR server and"," patient name to search for"),r.a.createElement(_.a,{onSubmit:this.handleSubmit},this.props.smart?null:a,r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Decedent name:"),r.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleChange})),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Decedent given name:"),r.a.createElement("input",{type:"text",name:"given",value:this.state.given,onChange:this.handleChange})),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Decedent family name:"),r.a.createElement("input",{type:"text",name:"family",value:this.state.family,onChange:this.handleChange})),r.a.createElement($.a,{primary:!0,disabled:""===this.props.fhirServer,type:"submit"},"Search")),(e=this.state.patients,t.state.searching?r.a.createElement(J.a,{active:!0,inline:"centered",content:"Loading"}):e?0===e.length?"No Results Found":r.a.createElement(D.a.Group,{className:"patients"},e.map(n)):null))}}]),t}(a.Component),ee="https://syntheticmass.mitre.org/fhir",te=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).state=K.retrieveState("stateWelcomePlain",{fhirServer:ee}),n.handlePatientSelect=n.handlePatientSelect.bind(Object(y.a)(n)),n.updateFhirServer=n.updateFhirServer.bind(Object(y.a)(n)),n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"handlePatientSelect",value:function(e){var t=this;B(this.state.fhirServer,e.id).then((function(e){var n=Object(d.a)(e,4),a=n[0],r=n[1],i=n[2],o=n[3];t.props.setResources(a,r,i,o)})),this.props.setPatient(e),this.props.gotoStep("Pronouncing")}},{key:"updateFhirServer",value:function(e){var t=this;this.setState({fhirServer:e},(function(){return K.storeState("stateWelcomePlain",t.state)}))}},{key:"render",value:function(){return r.a.createElement(X,{handlePatientSelect:this.handlePatientSelect,updateFhirServer:this.updateFhirServer,fhirServer:this.state.fhirServer})}}]),t}(a.Component),ne=window.location.href+"standalone",ae=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).state=K.retrieveState("stateWelcomeSmart",{fhirServer:"",clientId:"",secret:""}),n.handleChange=n.handleChange.bind(Object(y.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(y.a)(n)),n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"handleChange",value:function(e){var t=this,n=e.target;this.setState(Object(z.a)({},n.name,n.value),(function(){return K.storeState("stateWelcomeSmart",t.state)}))}},{key:"handleSubmit",value:function(e){e.preventDefault();var t=this.state.fhirServer,n={scope:"patient/*.read user/Patient.read launch openid profile online_access",client_id:this.state.clientId,redirect_uri:ne};this.state.secret&&(n.secret=this.state.secret),G({server:t,client:n}),o.a.render(r.a.createElement(u,null),document.getElementById("root"))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h3",null,"Specify information for the SMART on FHIR server to launch against"),r.a.createElement(_.a,{onSubmit:this.handleSubmit},r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"FHIR server:"),r.a.createElement("input",{type:"text",name:"fhirServer",value:this.state.fhirServer,onChange:this.handleChange})),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Client ID:"),r.a.createElement("input",{type:"text",name:"clientId",value:this.state.clientId,onChange:this.handleChange})),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Secret (if needed):"),r.a.createElement("input",{type:"password",name:"secret",value:this.state.secret,onChange:this.handleChange})),r.a.createElement("p",null,"Note: Specify ",r.a.createElement("tt",null,ne)," as the redirect URL on the SMART on FHIR server."),r.a.createElement("p",null,"Note: The information you enter above is stored in your local browser state to make it available across uses."),r.a.createElement($.a,{primary:!0,type:"submit"},"Connect")))}}]),t}(a.Component),re=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).state={selectedMenuItem:"plain"},n.handleMenuClick=n.handleMenuClick.bind(Object(y.a)(n)),n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"handleMenuClick",value:function(e,t){this.setState({selectedMenuItem:t.name})}},{key:"render",value:function(){var e=this.state.selectedMenuItem;return r.a.createElement("div",null,r.a.createElement("h2",null,"Welcome"),r.a.createElement("p",null,"The purpose of this application is to provide visualization, context, and decision support at the point of a patient's death, with the aim of improving the timeliness, accuracy, and completeness of mortality reporting. Source code and documentation can be ",r.a.createElement("a",{href:"https://github.com/nightingaleproject/fhir-death-refactor"},"found on GitHub"),"."),r.a.createElement(j.a,{pointing:!0},r.a.createElement(j.a.Item,{name:"plain",active:"plain"===e,onClick:this.handleMenuClick},"Connect to a plain FHIR server"),r.a.createElement(j.a.Item,{name:"smart",active:"smart"===e,onClick:this.handleMenuClick},"SMART on FHIR standalone launch")),"plain"===e?r.a.createElement(te,this.props):r.a.createElement(ae,this.props))}}]),t}(a.Component),ie=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).state={fhirServer:"",decedentName:""},n.handlePatientSelect=n.handlePatientSelect.bind(Object(y.a)(n)),n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=this;W().then((function(t){e.setState({fhirServer:t.server.serviceUrl})}))}},{key:"handlePatientSelect",value:function(e){var t=this;Z(e.id).then((function(e){var n=Object(d.a)(e,4),a=n[0],r=n[1],i=n[2],o=n[3];t.props.setResources(a,r,i,o)})),this.props.setPatient(e),this.props.gotoStep("Pronouncing")}},{key:"render",value:function(){return r.a.createElement(X,{smart:!0,handlePatientSelect:this.handlePatientSelect,fhirServer:this.state.fhirServer})}}]),t}(a.Component),oe=n(430),ce=n(424),le={register:function(e,t,n){this.fields[t]=this.fields[t]||[],n||(this.fields[t]=l.a.union(this.fields[t],[e]))},isComplete:function(e,t){var n=this.fields[e];if(!n)return!1;var a=l.a.pick(t,n);return l.a.chain(a).values().filter((function(e){return e})).value().length===n.length},fields:{}},se=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).input=n.input.bind(Object(y.a)(n)),n.radio=n.radio.bind(Object(y.a)(n)),n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"menuItem",value:function(e,t,n){var a=this,i=le.isComplete(e,this.props.record);return r.a.createElement(oe.a,{active:t===e,onClick:function(){return a.props.gotoStep(e)}},r.a.createElement(oe.a.Content,null,r.a.createElement(oe.a.Title,null,n&&r.a.createElement(s.a,{className:"completion-icon",color:"blue",name:i?"check":"exclamation triangle"}),e.replace(/([A-Z])/g," $1").trim())))}},{key:"menu",value:function(e){return this.currentStep=e,r.a.createElement(oe.a.Group,{size:"small",fluid:!0},this.menuItem("Pronouncing",e,!0),this.menuItem("CauseOfDeath",e,!0),this.menuItem("AdditionalQuestions",e,!0),this.menuItem("InjuryQuestions",e,!0),this.menuItem("ReviewAndSubmit",e,!1))}},{key:"input",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return le.register(t,this.currentStep,n.optional),r.a.createElement(_.a.Input,{width:n.width},r.a.createElement(ce.a,{type:e,name:t,value:this.props.record[t],label:n.label,labelPosition:n.label?"right":null,onChange:this.props.handleRecordChange}))}},{key:"textarea",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return le.register(e,this.currentStep,t.optional),r.a.createElement(_.a.TextArea,{rows:5,name:e,value:this.props.record[e],onChange:this.props.handleRecordChange})}},{key:"radio",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};le.register(t,this.currentStep,a.optional);var i=this.props.record[t]===n;return r.a.createElement(_.a.Field,null,r.a.createElement(_.a.Radio,{label:e,name:t,value:n,checked:i,onChange:this.props.handleRecordChange}))}},{key:"nextStepButton",value:function(e){var t=this;return r.a.createElement($.a,{primary:!0,floated:"right",onClick:function(){return t.props.gotoStep(e)}},"Go to ",e)}},{key:"componentDidMount",value:function(){this.setState({isComplete:le.isComplete(this.currentStep,this.props.record)})}}]),t}(a.Component),ue=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a.Row,null,this.menu("Pronouncing")),r.a.createElement(v.a.Row,null,r.a.createElement(v.a.Column,null,r.a.createElement(_.a,null,r.a.createElement(_.a.Group,{widths:"equal"},r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Date Pronounced Dead:"),this.input("date","pronouncedDeathDate")),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Actual or Presumed Date of Death:"),this.input("date","actualDeathDate"))),r.a.createElement(_.a.Group,{widths:"equal"},r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Time Pronounced Dead:"),this.input("time","pronouncedDeathTime")),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Actual or Presumed Time of Death:"),this.input("time","actualDeathTime"))),r.a.createElement(_.a.Group,{widths:"equal"},r.a.createElement(_.a.Field,null,r.a.createElement(_.a.Group,{grouped:!0},r.a.createElement("label",null,"Place of Death Type:"),this.radio("Dead on arrival at hospital","placeOfDeathType","Dead on arrival at hospital",{optional:!0}),this.radio("Death in home","placeOfDeathType","Death in home",{optional:!0}),this.radio("Death in hospice","placeOfDeathType","Death in hospice",{optional:!0}),this.radio("Death in hospital","placeOfDeathType","Death in hospital",{optional:!0}),this.radio("Death in hospital-based emergency department or outpatient department","placeOfDeathType","Death in hospital-based emergency department or outpatient department",{optional:!0}),this.radio("Death in nursing home or long term care facility","placeOfDeathType","Death in nursing home or long term care facility",{optional:!0}))),r.a.createElement(_.a.Field,null,r.a.createElement(_.a.Group,{grouped:!0},r.a.createElement("label",null,"Was Medical Examiner or Coroner Contacted?"),this.radio("Yes","examinerContacted","Yes"),this.radio("No","examinerContacted","No")))),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Name and Address of Place of Death")),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Name:"),this.input("text","placeOfDeathName")),r.a.createElement(_.a.Group,null,r.a.createElement(_.a.Field,{width:13},r.a.createElement("label",null,"Street:"),this.input("text","placeOfDeathStreet",{optional:!0})),r.a.createElement(_.a.Field,{width:3},r.a.createElement("label",null,"Apt:"),this.input("text","placeOfDeathApt",{optional:!0}))),r.a.createElement(_.a.Group,{widths:"equal"},r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"City:"),this.input("text","placeOfDeathCity",{optional:!0})),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"County:"),this.input("text","placeOfDeathCounty",{optional:!0})),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"State:"),this.input("text","placeOfDeathState",{optional:!0})),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Zip Code:"),this.input("text","placeOfDeathZip",{optional:!0}))),r.a.createElement("h2",null,"Person Pronouncing Death"),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Type your full name to electronically sign this document:"),this.input("text","pronouncerName")),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"License Number:"),this.input("text","pronouncerNumber")),this.nextStepButton("CauseOfDeath")))))}}]),t}(se),de=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).state={tab:"Conditions",searchString:""},n.gotoTab=n.gotoTab.bind(Object(y.a)(n)),n.handleSearchChange=n.handleSearchChange.bind(Object(y.a)(n)),n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"gotoTab",value:function(e){this.setState({tab:e})}},{key:"handleSearchChange",value:function(e,t){this.setState({searchString:t.value})}},{key:"render",value:function(){var e=this,t=function(e,t){return t&&0!==t.length?t.map((function(e){var t=e.prescriber;return r.a.createElement(D.a,{fluid:!0,key:e.id},r.a.createElement(D.a.Content,null,r.a.createElement(D.a.Header,null,e.description),t?r.a.createElement(D.a.Meta,null,"Prescribed by ",t.name):null,r.a.createElement(D.a.Meta,null,e.formattedDateRange),r.a.createElement(D.a.Description,null,e.additionalText)))})):r.a.createElement("p",null,"No ",e," found")},n=new RegExp(this.state.searchString,"gi"),a=function(e){return e.description&&e.description.match(n)},i=(this.props.conditions||[]).filter(a),o=(this.props.procedures||[]).filter(a),c=(this.props.observations||[]).filter(a),l=(this.props.medications||[]).filter(a),u=function(t,n){return n=n||[],r.a.createElement(j.a.Item,{active:e.state.tab===t,onClick:function(){return e.gotoTab(t)}},t," (",n.length,")")};return r.a.createElement("div",{className:"timeline"},r.a.createElement(j.a,{tabular:!0},u("Conditions",i),u("Procedures",o),u("Tests",c),u("Medications",l)),r.a.createElement(ce.a,{fluid:!0,icon:"search",placeholder:"Search...",onChange:this.handleSearchChange}),function(n){switch(n){case"Conditions":default:return(a=i)&&0!==a.length?a.map((function(t){var n=e.props.selectedConditions.includes(t);return r.a.createElement(D.a,{fluid:!0,key:t.id,id:t.id,onClick:e.props.handleConditionClick},r.a.createElement(D.a.Content,null,r.a.createElement(D.a.Header,null,t.description," ",n?r.a.createElement(s.a,{name:"check"}):null),r.a.createElement(D.a.Meta,null,t.formattedDateRange)))})):r.a.createElement("p",null,"No conditions found");case"Procedures":return t("procedures",o);case"Tests":return t("tests",c);case"Medications":return t("medications",l)}var a}(this.state.tab))}}]),t}(a.Component),he=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this,t=function(t){if(t)return r.a.createElement($.a,{icon:"delete",id:t.id,onClick:e.props.handleConditionClick})};return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a.Row,null,this.menu("CauseOfDeath")),r.a.createElement(v.a.Row,null,r.a.createElement(v.a.Column,{width:8},r.a.createElement(de,{conditions:this.props.conditions,selectedConditions:this.props.selectedConditions,medications:this.props.medications,procedures:this.props.procedures,observations:this.props.observations,handleConditionClick:this.props.handleConditionClick})),r.a.createElement(v.a.Column,{width:8},r.a.createElement(_.a,null,r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Immediate Cause")),r.a.createElement(_.a.Group,null,this.input("text","cod1Time",{width:4}),this.input("text","cod1Text",{width:12,label:t(this.props.selectedConditions[0])})),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Underlying Causes")),r.a.createElement(_.a.Group,null,this.input("text","cod2Time",{width:4,optional:!0}),this.input("text","cod2Text",{width:12,optional:!0,label:t(this.props.selectedConditions[1])})),r.a.createElement(_.a.Group,null,this.input("text","cod3Time",{width:4,optional:!0}),this.input("text","cod3Text",{width:12,optional:!0,label:t(this.props.selectedConditions[2])})),r.a.createElement(_.a.Group,null,this.input("text","cod4Time",{width:4,optional:!0}),this.input("text","cod4Text",{width:12,optional:!0,label:t(this.props.selectedConditions[3])})),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Other Significant Conditions")),this.textarea("contributing",{optional:!0}),this.nextStepButton("AdditionalQuestions")))))}}]),t}(se),fe=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a.Row,null,this.menu("AdditionalQuestions")),r.a.createElement(v.a.Row,null,r.a.createElement(v.a.Column,{width:8},r.a.createElement(_.a,null,r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Was an Autopsy Performed?")),this.radio("Yes","autopsyPerformed","Yes"),this.radio("No","autopsyPerformed","No"),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Were Autopsy Findings Available to Complete the Case of Death?")),this.radio("Yes","autopsyAvailable","Yes"),this.radio("No","autopsyAvailable","No"),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Manner of Death:")),this.radio("Natural","mannerOfDeath","Natural"),this.radio("Homicide","mannerOfDeath","Homicide"),this.radio("Accident","mannerOfDeath","Accident"),this.radio("Suicide","mannerOfDeath","Suicide"),this.radio("Pending Investigation","mannerOfDeath","Pending Investigation"),this.radio("Could not be Determined","mannerOfDeath","Could not be determined"))),r.a.createElement(v.a.Column,{width:8},r.a.createElement(_.a,null,r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Did tobacco use contribute to death?")),this.radio("Yes","tobacco","Yes"),this.radio("No","tobacco","No"),this.radio("Probably","tobacco","Probably"),this.radio("Unknown","tobacco","Unknown"),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"If female:")),this.radio("Not pregnant within past year","pregnancy","Not pregnant within past year",{optional:!0}),this.radio("Pregnant at time of death","pregnancy","Pregnant at time of death",{optional:!0}),this.radio("Not pregnant, but pregnant within 42 days of death","pregnancy","Not pregnant, but pregnant within 42 days of death",{optional:!0}),this.radio("Not pregnant, but pregnant 43 days to 1 year before death","pregnancy","Not pregnant, but pregnant 43 days to 1 year before death",{optional:!0}),this.radio("Unknown if pregnant within the past year","pregnancy","Unknown if pregnant within the past year",{optional:!0}),this.nextStepButton("InjuryQuestions")))))}}]),t}(se),pe=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a.Row,null,this.menu("InjuryQuestions")),r.a.createElement(v.a.Row,null,r.a.createElement(v.a.Column,null,r.a.createElement(_.a,null,r.a.createElement(_.a.Group,{widths:"equal"},r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Date of Injury:"),this.input("date","dateOfInjury",{optional:!0})),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Time of Injury:"),this.input("time","timeOfInjury",{optional:!0}))),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Place of Injury:"),this.input("text","placeOfInjury",{optional:!0})),r.a.createElement(v.a,null,r.a.createElement(v.a.Row,null,r.a.createElement(v.a.Column,{width:8},r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Injury at work?")),this.radio("Yes","injuryAtWork","Yes",{optional:!0}),this.radio("No","injuryAtWork","No",{optional:!0})),r.a.createElement(v.a.Column,{width:8},r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"If transportation injury, specify")),this.radio("Driver/Operator","transportationInjury","Vehicle driver",{optional:!0}),this.radio("Passenger","transportationInjury","Passenger",{optional:!0}),this.radio("Pedestrian","transportationInjury","Pedestrian",{optional:!0}),this.radio("Other","transportationInjury","Other",{optional:!0})))),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Address of Injury")),r.a.createElement(_.a.Group,null,r.a.createElement(_.a.Field,{width:13},r.a.createElement("label",null,"Street:"),this.input("text","locationOfInjuryStreet",{optional:!0})),r.a.createElement(_.a.Field,{width:3},r.a.createElement("label",null,"Apt:"),this.input("text","locationOfInjuryApt",{optional:!0}))),r.a.createElement(_.a.Group,{widths:"equal"},r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"City:"),this.input("text","locationOfInjuryCity",{optional:!0})),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"County:"),this.input("text","locationOfInjuryCounty",{optional:!0})),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"State:"),this.input("text","locationOfInjuryState",{optional:!0})),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Zip Code:"),this.input("text","locationOfInjuryZip",{optional:!0}))),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Describe how injury occurred")),this.textarea("howInjuryOccurred",{optional:!0}),this.nextStepButton("ReviewAndSubmit")))))}}]),t}(se),me=n(431),ye=n(147),be=n.n(ye),ve=function(e,t){return e&&t?O.a.utc("".concat(e," ").concat(t),"YYYY-MM-DD HH:mm").format():e?O.a.utc(e,"YYYY-MM-DD").format():void 0},ge=function(){function e(){Object(h.a)(this,e),this.id=be()()}return Object(f.a)(e,[{key:"addExtension",value:function(e){this.extension=this.extension||[],this.extension.push(e)}},{key:"setProfile",value:function(e){this.meta={profile:[e]}}}]),e}(),Oe=function(e){function t(){var e;return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this))).resourceType="Bundle",e}return Object(b.a)(t,e),Object(f.a)(t,[{key:"addEntry",value:function(e){if(!e)throw new Error("Error: addEntry called without a resource to add");this.entry=this.entry||[];var t={fullUrl:"urn:uuid:".concat(be()()),resource:e};return this.entry.push(t),t}}]),t}(ge),je=function(e){function t(){var e;return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this))).resourceType="Composition",e}return Object(b.a)(t,e),t}(ge),Ee=function(e){function t(){var e;return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this))).resourceType="Procedure",e}return Object(b.a)(t,e),t}(ge),De=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this))).resourceType="Condition",n.code?e.code=new Ae(n.code,"http://hl7.org/fhir/sid/icd-10",null):n.text&&(e.code=new Ae(null,null,n.text)),e}return Object(b.a)(t,e),Object(f.a)(t,[{key:"addDecedentReference",value:function(e){this.subject={reference:e.fullUrl}}},{key:"addPerformerReference",value:function(e){this.asserter={reference:e.fullUrl}}}]),t}(ge),Ce=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object(h.a)(this,t),e=Object(p.a)(this,Object(m.a)(t).call(this)),n.name&&(e.name=e.name||[],e.name.push(new Ne(n.name))),n.address&&(e.address=[new Fe(n.address)]),n.qualification){var a={};n.qualification.identifier&&(a.identifier=[{value:n.qualification.identifier}]),n.qualification.code&&(a.code=new Ae(n.qualification.code,"http://hl7.org/fhir/v2/0360/2.7",n.qualification.text)),e.qualification=[a]}return e}return Object(b.a)(t,e),t}(ge),Se=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,n))).resourceType="Practitioner",e}return Object(b.a)(t,e),t}(Ce),we=function(e){function t(){var e;return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this))).resourceType="PractitionerRole",e}return Object(b.a)(t,e),t}(ge),Re=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,n))).resourceType="Patient",e}return Object(b.a)(t,e),t}(Ce),Pe=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this))).resourceType="Organization",n.name&&(e.name=n.name),n.address&&(e.address=[new Fe(n.address)]),e}return Object(b.a)(t,e),t}(ge),ke=function(e){function t(){var e;arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this))).resourceType="List",e}return Object(b.a)(t,e),t}(ge),xe=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,n))).resourceType="RelatedPerson",e}return Object(b.a)(t,e),Object(f.a)(t,[{key:"addDecedentReference",value:function(e){this.patient={reference:e.fullUrl}}}]),t}(Ce),Ie=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this))).resourceType="Observation",e.status="final",e.code=new Ae(n.code,n.system,n.display),e}return Object(b.a)(t,e),Object(f.a)(t,[{key:"addDecedentReference",value:function(e){this.subject={reference:e.fullUrl}}},{key:"addPerformerReference",value:function(e){this.performer=[{reference:e.fullUrl}]}},{key:"addLocationReference",value:function(e){var t={reference:e.fullUrl},n=e.resource.meta.profile[0];this.addExtension({url:n,valueReference:t})}},{key:"addComponent",value:function(e,t){this.component=this.component||[];var n={code:new Ae(e.code,e.system,e.display)};t.code?n.valueCodeableConcept=new Ae(t.code,t.system,t.display):t.date?n.valueDateTime=ve(t.date,t.time):t.text&&(n.valueString=t.text),this.component.push(n)}}]),t}(ge),Te=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this))).resourceType="Location",n.name&&(e.name=n.name),n.description&&(e.description=n.description),n.address&&(e.address=new Fe(n.address)),n.type&&(e.type=new Ae(n.type.code,"http://hl7.org/fhir/ValueSet/v3-ServiceDeliveryLocationRoleType",n.type.text)),n.physicalType&&(e.physicalType=new Ae(n.physicalType.code,"http://hl7.org/fhir/ValueSet/location-physical-type",n.physicalType.text)),e}return Object(b.a)(t,e),t}(ge),Ae=function e(t,n,a){Object(h.a)(this,e),t&&(this.coding=n&&a?[{system:n,code:t,display:a}]:n?[{system:n,code:t}]:a?[{code:t,display:a}]:[{code:t}]),a&&(this.text=a)},Ne=function e(t,n){Object(h.a)(this,e);var a=t.match(/(.+)\s+(\S+)/);a?(this.given=a[1].split(/\s+/),this.family=a[2]):(a=t.match(/\S+/))&&(this.given=[a[0]]),this.use="official"},Fe=function e(t){Object(h.a)(this,e),this.type="postal",Object.assign(this,t)},Me=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this))).type="document",n.identifier&&(e.identifier={value:n.identifier});var a=e.createAndAddEntry(null,He,n.deathCertificate),r=Object(d.a)(a,1)[0],i=e.createAndAddEntry(r,Le,n.decedent),o=Object(d.a)(i,2)[1];o&&r.addDecedentReference(o);var c=e.createAndAddEntry(r,Ue,n.certifier),l=Object(d.a)(c,2)[1];l&&r.addPerformerReference(l);var s=e.createAndAddEntry(r,Ve,n.deathCertification,null,l),u=Object(d.a)(s,2)[1];u&&r.addCertificationReference(u);var f=e.createAndAddEntry(r,st,n.deathLocation),y=Object(d.a)(f,2)[1],b=e.createAndAddEntry(r,Ye,n.mortician),v=Object(d.a)(b,2)[1],g=e.createAndAddEntry(r,ht,n.dispositionLocation),O=Object(d.a)(g,2)[1],j=e.createAndAddEntry(r,ze,n.funeralHome),E=Object(d.a)(j,2)[1];e.createAndAddEntry(r,Be,n.decedentFather,o),e.createAndAddEntry(r,We,n.decedentMother,o),e.createAndAddEntry(r,Ge,n.decedentSpouse,o),e.createAndAddEntry(r,qe,n.decedentAge,o),e.createAndAddEntry(r,Ze,n.decedentPregnancy,o),e.createAndAddEntry(r,Qe,n.decedentTransportationRole,o),e.createAndAddEntry(r,tt,n.tobaccoUseContributedToDeath,o),e.createAndAddEntry(r,nt,n.decedentEducationLevel,o),e.createAndAddEntry(r,at,n.decedentEmploymentHistory,o),e.createAndAddEntry(r,rt,n.birthRecordIdentifier,o),e.createAndAddEntry(r,it,n.mannerOfDeath,o,l),e.createAndAddEntry(r,lt,n.autopsyPerformed,o),e.createAndAddEntry(r,et,n.examinerContacted,o),e.createAndAddEntry(r,_e,n.interestedParty),e.createAndAddEntry(r,Xe,n.conditionContributingToDeath,o),e.createAndAddEntry(r,ut,n.deathDate,o,l,y),e.createAndAddEntry(r,dt,n.deathPronouncementPerformer),e.createAndAddEntry(r,ot,n.injuryIncident,o,y),e.createAndAddEntry(r,ct,n.injuryLocation),e.createAndAddEntry(r,ft,n.decedentDispositionMethod,o,v,O);var D=e.createAndAddEntry(r,Je,n.funeralHomeDirector,null,v),C=Object(d.a)(D,1)[0];C&&C.addFuneralHomeReference(E);var S=e.createAndAddEntry(r,$e,{},null,l),w=Object(d.a)(S,1)[0];if(n.causeOfDeathConditions){var R=!0,P=!1,k=void 0;try{for(var x,I=n.causeOfDeathConditions[Symbol.iterator]();!(R=(x=I.next()).done);R=!0){var T=x.value,A=e.createAndAddEntry(r,Ke,T,o,l),N=Object(d.a)(A,2)[1];w.addCauseOfDeathReference(N)}}catch(F){P=!0,k=F}finally{try{R||null==I.return||I.return()}finally{if(P)throw k}}}return e.setProfile("http://hl7.org/fhir/us/vrdr/StructureDefinition/VRDR-Death-Certificate-Document"),e}return Object(b.a)(t,e),Object(f.a)(t,[{key:"createAndAddEntry",value:function(e,t,n,a,r,i){if(!n)return[null,null];var o=new t(n);a&&o.addDecedentReference(a),r&&o.addPerformerReference(r),i&&o.addLocationReference(i);var c=this.addEntry(o);return e&&e.addSectionEntry(c),[o,c]}}]),t}(Oe),He=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),e=Object(p.a)(this,Object(m.a)(t).call(this)),n.identifier&&(e.identifier={value:n.identifier}),e.setProfile("http://hl7.org/fhir/us/vrdr/StructureDefinition/VRDR-Death-Certificate"),e}return Object(b.a)(t,e),Object(f.a)(t,[{key:"addDecedentReference",value:function(e){this.subject={reference:e.fullUrl}}},{key:"addPerformerReference",value:function(e){this.attester=[{mode:["legal"],party:{reference:e.fullUrl}}]}},{key:"addCertificationReference",value:function(e){var t=new Ae("103693007","http://snomed.info/sct","Diagnostic procedure");this.event=[{code:[t],detail:[{reference:e.fullUrl}]}]}},{key:"addSectionEntry",value:function(e){this.section=this.section||[{entry:[]}],this.section[0].entry.push({reference:e.fullUrl})}}]),t}(je),Ve=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this))).setProfile("http://hl7.org/fhir/us/vrdr/StructureDefinition/VRDR-Death-Certification"),e.status="completed",e.category=new Ae("103693007","http://snomed.info/sct","Diagnostic procedure"),e.code=new Ae("308646001","http://snomed.info/sct","Death certification"),e.performedDateTime=ve(n.performedDate,n.performedTime),e}return Object(b.a)(t,e),Object(f.a)(t,[{key:"addPerformerReference",value:function(e){this.performer=[{role:new Ae("309343006","http://snomed.info/sct","Physician"),actor:{reference:e.fullUrl}}]}}]),t}(Ee),Ue=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,n))).setProfile("http://hl7.org/fhir/us/vrdr/StructureDefinition/VRDR-Certifier"),e}return Object(b.a)(t,e),t}(Se),Ye=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,n))).setProfile("http://hl7.org/fhir/us/vrdr/StructureDefinition/VRDR-Mortician"),e}return Object(b.a)(t,e),t}(Se),Le=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object(h.a)(this,t),e=Object(p.a)(this,Object(m.a)(t).call(this,n)),n.race){var a=[],r=l.a.castArray(n.race),i=r.filter((function(e){return e.text})).map((function(e){return e.text})).join(" ");i.length>0&&a.push({url:"text",valueString:i});var o=!0,c=!1,s=void 0;try{for(var u,d=r.filter((function(e){return e.code}))[Symbol.iterator]();!(o=(u=d.next()).done);o=!0){var f=u.value,y={system:"urn:oid:2.16.840.1.113883.6.238",code:f.code,display:f.text};a.push({url:f.type,valueCoding:y})}}catch(g){c=!0,s=g}finally{try{o||null==d.return||d.return()}finally{if(c)throw s}}e.addExtension({url:"http://hl7.org/fhir/us/core/StructureDefinition/us-core-race",extension:a})}if(n.ethnicity){var b=[];if(n.ethnicity.text&&b.push({url:"text",valueString:n.ethnicity.text}),n.ethnicity.code){var v={system:"urn:oid:2.16.840.1.113883.6.238",code:n.ethnicity.code};n.ethnicity.text&&(v.display=n.ethnicity.text),b.push({url:"ombCategory",valueCoding:v})}e.addExtension({url:"http://hl7.org/fhir/us/core/StructureDefinition/us-core-ethnicity",extension:b})}return n.birthSex&&e.addExtension({url:"http://hl7.org/fhir/us/core/StructureDefinition/us-core-birthsex",valueCodeableConcept:new Ae(n.birthSex,"http://hl7.org/fhir/us/core/ValueSet/us-core-birthsex")}),n.birthPlace&&e.addExtension({url:"http://hl7.org/fhir/StructureDefinition/birthPlace",valueAddress:n.birthPlace}),n.ssn&&(e.identifier=[{type:new Ae("BR",null,"Social Beneficiary Identifier"),system:"http://hl7.org/fhir/sid/us-ssn",value:n.ssn}]),n.gender&&(e.gender=n.gender),n.birthDate&&(e.birthDate=ve(n.birthDate,null)),n.maritalStatus&&(e.maritalStatus=new Ae(n.maritalStatus,"http://hl7.org/fhir/vs/marital-status")),e}return Object(b.a)(t,e),t}(Re),Be=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,n))).setProfile("http://hl7.org/fhir/us/vrdr/StructureDefinition/VRDR-Decedent-Father"),e.relationship=new Ae("FTH"),e}return Object(b.a)(t,e),t}(xe),We=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,n))).setProfile("http://hl7.org/fhir/us/vrdr/StructureDefinition/VRDR-Decedent-Mother"),e.relationship=new Ae("MTH"),e}return Object(b.a)(t,e),t}(xe),Ge=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,n))).setProfile("http://hl7.org/fhir/us/vrdr/StructureDefinition/VRDR-Decedent-Spouse"),e.relationship=new Ae("SPS"),e}return Object(b.a)(t,e),t}(xe),qe=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,{code:"30525-0",system:"http://loinc.org",display:"Age"}))).setProfile("http://hl7.org/fhir/us/vrdr/VRDR-Decedent-Age"),e.valueQuantity={unit:n.unit,value:n.value},e}return Object(b.a)(t,e),t}(Ie),Ze=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,{code:"69442-2",system:"http://loinc.org",display:"Timing of recent pregnancy in relation to death"}))).setProfile("http://hl7.org/fhir/us/vrdr/VRDR-Decedent-Pregnancy"),e.valueCodeableConcept=new Ae(n.code,"http://hl7.org/fhir/stu3/valueset-PregnancyStatusVS",n.text),e}return Object(b.a)(t,e),t}(Ie),Qe=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,{code:"69451-3",system:"http://loinc.org",display:"Transportation role of decedent"}))).setProfile("http://hl7.org/fhir/us/vrdr/VRDR-Decedent-Transportation-Role"),e.valueCodeableConcept=new Ae(n.code,"http://hl7.org/fhir/ValueSet/TransportationRelationships",n.text),e}return Object(b.a)(t,e),t}(Ie),ze=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,n))).setProfile("http://hl7.org/fhir/us/vrdr/StructureDefinition/VRDR-Funeral-Home"),e.type=[new Ae("bus",null,"Non-Healthcare Business or Corporation")],e}return Object(b.a)(t,e),t}(Pe),Je=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,n))).setProfile("http://hl7.org/fhir/us/vrdr/StructureDefinition/VRDR-Funeral-Home-Director"),e}return Object(b.a)(t,e),Object(f.a)(t,[{key:"addPerformerReference",value:function(e){this.practitioner={reference:e.fullUrl}}},{key:"addFuneralHomeReference",value:function(e){this.organization={reference:e.fullUrl}}}]),t}(we),_e=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,n))).setProfile("http://hl7.org/fhir/us/vrdr/StructureDefinition/VRDR-Interested-Party"),n.identifier&&(e.identifier=[{value:n.identifier}]),e.active="true",n.typeCode&&(e.type=[new Ae(n.typeCode,"http://hl7.org/fhir/ValueSet/organization-type",n.typeDisplay)]),e}return Object(b.a)(t,e),t}(Pe),$e=function(e){function t(){var e;return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this))).setProfile("http://hl7.org/fhir/us/vrdr/StructureDefinition/VRDR-Cause-of-Death-Pathway"),e.status="current",e.mode="snapshot",e.orderedBy=new Ae("priority"),e}return Object(b.a)(t,e),Object(f.a)(t,[{key:"addPerformerReference",value:function(e){this.source={reference:e.fullUrl}}},{key:"addCauseOfDeathReference",value:function(e){this.entry=this.entry||[],this.entry.push({item:{reference:e.fullUrl}})}}]),t}(ke),Ke=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).setProfile("http://hl7.org/fhir/us/vrdr/StructureDefinition/VRDR-Cause-of-Death-Condition"),e.interval&&(n.onsetString=e.interval),n}return Object(b.a)(t,e),t}(De),Xe=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).setProfile("http://hl7.org/fhir/us/vrdr/StructureDefinition/VRDR-Condition-Contributing-To-Death"),n}return Object(b.a)(t,e),t}(De),et=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,{code:"74497-9",system:"http://loinc.org",display:"Medical examiner or coroner was contacted"}))).setProfile("http://hl7.org/fhir/us/vrdr/VRDR-Examiner-Contacted"),e.valueBoolean=n.value,e}return Object(b.a)(t,e),t}(Ie),tt=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,{code:"69443-0",system:"http://loinc.org",display:"Did tobacco use contribute to death"}))).setProfile("http://hl7.org/fhir/us/vrdr/VRDR-Tobacco-Use-Contributed-To-Death"),e.valueCodeableConcept=new Ae(n.code,"http://hl7.org/fhir/ValueSet/v2-0532",n.text),e}return Object(b.a)(t,e),t}(Ie),nt=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,{code:"80913-7",system:"http://loinc.org",display:"Highest level of education"}))).setProfile("http://hl7.org/fhir/us/vrdr/VRDR-Decedent-Education-Level"),e.valueCodeableConcept=new Ae(n.code,"http://www.hl7.org/fhir/ValueSet/v3-EducationLevel",n.text),e}return Object(b.a)(t,e),t}(Ie),at=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,{code:"74165-2",system:"http://loinc.org",display:"History of employment status"}))).setProfile("http://hl7.org/fhir/us/vrdr/VRDR-Decedent-Employment-History"),n.militaryService&&e.addComponent({code:"55280-2",system:"http://loinc.org",display:"Military service Narrative"},{code:n.militaryService.code,system:"http://hl7.org/fhir/ValueSet/v2-0532",display:n.militaryService.text}),n.usualIndustry&&e.addComponent({code:"21844-6",system:"http://loinc.org",display:"History of Usual industry"},{code:n.usualIndustry.code,system:"http://hl7.org/fhir/ValueSet/industry-cdc-census-2010",display:n.usualIndustry.text}),n.usualOccupation&&e.addComponent({code:"21847-9",system:"http://loinc.org",display:"Usual occupation Narrative"},{code:n.usualOccupation.code,system:"http://hl7.org/fhir/ValueSet/Usual-occupation",display:n.usualOccupation.text}),e}return Object(b.a)(t,e),t}(Ie),rt=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,{code:"BR",system:"urn:oid:2.16.840.1.113883.6.290",display:"Birth Record"}))).setProfile("http://hl7.org/fhir/us/vrdr/VRDR-Birth-Record-Identifier"),e.valueString=n.certificateNumber,n.birthYear&&e.addComponent({code:"21112-8",system:"http://loinc.org",display:"Birth date"},{date:n.birthYear}),n.birthState&&e.addComponent({code:"21842-0",system:"http://loinc.org",display:"Birthplace"},{code:n.birthState,system:"ISO 3166-2"}),e}return Object(b.a)(t,e),t}(Ie),it=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,{code:"69449-7",system:"http://loinc.org",display:"Manner of death"}))).setProfile("http://hl7.org/fhir/us/vrdr/VRDR-Manner-of-Death"),e.valueCodeableConcept=new Ae(n.code,"http://hl7.org/fhir/stu3/valueset-MannerTypeVS",n.text),e}return Object(b.a)(t,e),t}(Ie),ot=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,{code:"11374-6",system:"http://loinc.org",display:"Injury incident description"}))).setProfile("http://hl7.org/fhir/us/vrdr/VRDR-Injury-Incident"),e.valueString=n.text,n.effectiveDate&&(e.effectiveDateTime=ve(n.effectiveDate,n.effectiveTime)),n.placeOfInjury&&e.addComponent({code:"69450-5",system:"http://loinc.org",display:"Place of injury"},{text:n.placeOfInjury}),n.transportationEventIndicator&&e.addComponent({code:"69448-9",system:"http://loinc.org",display:"Injury leading to death associated with transportation event"},{code:n.transportationEventIndicator.code,system:"http://hl7.org/fhir/ValueSet/v2-0532",display:n.transportationEventIndicator.text}),n.workInjuryIndicator&&e.addComponent({code:"69444-8",system:"http://loinc.org",display:"Injury at work?"},{code:n.workInjuryIndicator.code,system:"http://hl7.org/fhir/ValueSet/v2-0532",display:n.workInjuryIndicator.text}),e}return Object(b.a)(t,e),t}(Ie),ct=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,n))).setProfile("http://hl7.org/fhir/us/vrdr/VRDR-Injury-Location"),e}return Object(b.a)(t,e),t}(Te),lt=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,{code:"85699-7",system:"http://loinc.org",display:"Autopsy was performed"}))).setProfile("http://hl7.org/fhir/us/vrdr/VRDR-Autopsy-Performed-Indicator"),e.valueCodeableConcept=new Ae(n.code,"http://hl7.org/fhir/ValueSet/v2-0532",n.text),n.autopsyAvailable&&e.addComponent({code:"69436-4",system:"http://loinc.org",display:"Autopsy results available"},{code:n.autopsyAvailable.code,system:"http://hl7.org/fhir/ValueSet/v2-0532",display:n.autopsyAvailable.text}),e}return Object(b.a)(t,e),t}(Ie),st=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,n))).setProfile("http://hl7.org/fhir/us/vrdr/VRDR-Death-Location"),e}return Object(b.a)(t,e),t}(Te),ut=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,{code:"81956-5",system:"http://loinc.org",display:"Date and time of death"}))).setProfile("http://hl7.org/fhir/us/vrdr/VRDR-Death-Date"),n.effectiveDate&&(e.effectiveDateTime=ve(n.effectiveDate,n.effectiveTime)),n.comment&&(e.comment=n.comment),n.method&&(e.method=new Ae(n.method.code,"http://snomed.info/sct",n.method.text)),n.pronouncedDate&&e.addComponent({code:"80616-6",system:"http://loinc.org",display:"Date and time pronounced dead"},{date:n.pronouncedDate,time:n.pronouncedTime}),e}return Object(b.a)(t,e),t}(Ie),dt=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,n))).setProfile("http://hl7.org/fhir/us/vrdr/VRDR-Death-Pronouncement-Performer"),e}return Object(b.a)(t,e),t}(Se),ht=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,n))).setProfile("http://hl7.org/fhir/us/vrdr/VRDR-Disposition-Location"),e}return Object(b.a)(t,e),t}(Te),ft=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(h.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this,{code:"80905-3",system:"http://loinc.org",display:"Body disposition method"}))).setProfile("http://hl7.org/fhir/us/vrdr/VRDR-Decedent-Disposition-Method"),e.valueCodeableConcept=new Ae(n.code,"http://hl7.org/fhir/stu3/DispositionTypeVS",n.text),e}return Object(b.a)(t,e),t}(Ie);function pt(e,t,n,a,r){var i={};return e&&(i.line=[e]),t&&(i.city=t),n&&(i.district=n),a&&(i.state=a),r&&(i.postalCode=r),i}function mt(e){var t={Yes:"Y",No:"N"}[e];return t?{code:t,text:e}:null}function yt(e,t,n){t&&n?e.push({text:t,interval:n}):t&&e.push({text:t})}function bt(e,t){var n={deathCertificate:{}};n.deathCertification={performedDate:O()().format("YYYY-MM-DD"),performedTime:O()().format("HH:mm")},e.certifierName&&(n.certifier={name:e.certifierName,address:pt(e.certifierStreet,e.certifierCity,e.certifierCounty,e.certifierState,e.certifierZip)}),t&&(n.decedent={name:t.name,birthPlace:t.resource.birthPlace,gender:t.resource.gender,birthDate:t.resource.birthDate,maritalStatus:l.a.get(t,"resource.maritalStatus.coding[0].code")}),e.pregnancy&&(n.decedentPregnancy=function(e){var t={"Not pregnant within past year":"PHC1260","Pregnant at time of death":"PHC1261","Not pregnant, but pregnant within 42 days of death":"PHC1262","Not pregnant, but pregnant 43 days to 1 year before death":"PHC1263","Unknown if pregnant within the past year":"PHC1264"}[e];return t?{code:t,text:e}:null}(e.pregnancy)),e.tobacco&&(n.tobaccoUseContributedToDeath=mt(e.tobacco)),e.mannerOfDeath&&(n.mannerOfDeath=function(e){var t={Natural:"38605008",Accident:"7878000",Suicide:"44301001",Homicide:"27935005","Pending Investigation":"185973002","Could not be determined":"65037004"}[e];return t?{code:t,text:e}:null}(e.mannerOfDeath)),e.autopsyPerformed&&(n.autopsyPerformed=mt(e.autopsyPerformed),e.autopsyAvailable&&(n.autopsyPerformed.autopsyAvailable=mt(e.autopsyAvailable))),e.placeOfDeathName&&(n.deathLocation={name:e.placeOfDeathName,address:pt(e.placeOfDeathStreet,e.placeOfDeathCity,e.placeOfDeathCounty,e.placeOfDeathStat,e.placeOfDeathZip),type:{code:"HOSP",text:"Hospital"},physicalType:{code:"wa",text:"Ward"}}),e.actualDeathDate&&(n.deathDate={effectiveDate:e.actualDeathDate,effectiveTime:e.actualDeathTime,method:{code:"414135002",text:"Estimated"}}),e.pronouncedDeathDate&&(n.deathDate=n.deathDate||{},n.deathDate.pronouncedDate=e.pronouncedDeathDate,n.deathDate.pronouncedTime=e.pronouncedDeathTime),e.transportationInjury&&(n.decedentTransportationRole=function(e){var t={"Vehicle driver":"236320001",Passenger:"257500003",Pedestrian:"257518000",Other:"OTH"}[e];return t?{code:t,text:e}:null}(e.transportationInjury)),e.dateOfInjury&&(n.injuryIncident={effectiveDate:e.dateOfInjury,effectiveTime:e.timeOfInjury},e.placeOfInjury&&(n.injuryIncident.placeOfInjury=e.placeOfInjury),e.injuryAtWork&&(n.workInjuryIndicator=mt(e.injuryAtWork)),n.transportationEventIndicator=mt(e.transportationInjury?"Yes":"No")),e.howInjuryOccurred&&(n.injuryLocation={description:e.howInjuryOccurred}),e.locationOfInjuryState&&(n.injuryLocation=n.injuryLocation||{},n.injuryLocation.address=pt(e.locationOfInjuryStreet,e.locationOfInjuryCity,e.locationOfInjuryCounty,e.locationOfInjuryState,e.placeOfDeathZip));var a,r=[];return yt(r,e.cod1Text,e.cod1Time),yt(r,e.cod2Text,e.cod2Time),yt(r,e.cod3Text,e.cod3Time),yt(r,e.cod4Text,e.cod4Time),r.length>0&&(n.causeOfDeathConditions=r),e.contributing&&(n.conditionContributingToDeath={text:e.contributing}),e.examinerContacted&&(n.examinerContacted={value:(a=e.examinerContacted,{Yes:"true",No:"false"}[a])}),new Me(n)}var vt=n(218),gt=n.n(vt),Ot=function(e){function t(e){var n;Object(h.a)(this,t);return(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).state=K.retrieveState("stateReviewAndSubmit",{edrsEndpoint:"http://localhost:4000/fhir/v1/death_records.json"}),n.handleChange=n.handleChange.bind(Object(y.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(y.a)(n)),n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"handleChange",value:function(e){var t=this,n=e.target;this.setState(Object(z.a)({},n.name,n.value),(function(){return K.storeState("stateReviewAndSubmit",t.state)}))}},{key:"handleSubmit",value:function(){var e=this,t=bt(this.props.record,this.props.patient),n={url:this.state.edrsEndpoint,type:"POST",data:JSON.stringify(t),contentType:"application/json",dataType:"json",success:function(e){alert("Successfully submitted data to server")},error:function(e){201===e.status?alert("Successfully submitted data to server"):alert("Failed to submit data to server, error reported: "+e.statusText)}};this.state.bearerToken&&(n.beforeSend=function(t,n){t.setRequestHeader("Authorization","Bearer "+e.state.bearerToken)},n.headers={Authorization:"Bearer "+this.state.bearerToken}),gt.a.ajax(n)}},{key:"render",value:function(){var e=this,t=this.props.record,n=function(e,t){return r.a.createElement(v.a.Row,null,r.a.createElement(v.a.Column,{width:4},r.a.createElement("div",{className:"review-title"},e)),r.a.createElement(v.a.Column,{width:12},r.a.createElement(me.a,{content:t})))};return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a.Row,null,this.menu("ReviewAndSubmit")),r.a.createElement(v.a.Row,null,r.a.createElement(v.a.Column,null,r.a.createElement(v.a,null,n("Date Pronounced Dead",t.pronouncedDeathDate),n("Time Pronounced Dead",t.pronouncedDeathTime),n("Actual or Presumed Date of Death",t.actualDeathDate),n("Actual or Presumed Time of Death",t.actualDeathTime),n("Was Medical Examiner or Coroner Contacted?",t.examinerContacted),n("Was an Autopsy Performed?",t.autopsyPerformed),n("Were Autopsy Findings Available to Complete the Cause of Death?",t.autopsyAvailable),n("Name of Place of Death",t.placeOfDeathName),n("Type of Place of Death",t.placeOfDeathType),n("Place of Death (State)",t.placeOfDeathState),n("Place of Death (County)",t.placeOfDeathCounty),n("Place of Death (City)",t.placeOfDeathCity),n("Place of Death (Street)",t.placeOfDeathStreet),n("Place of Death (Apt)",t.placeOfDeathApt),n("Place of Death (Zip)",t.placeOfDeathZip),n("Person Pronouncing Death",t.pronouncerName),n("License Number of Person Pronouncing Death",t.pronouncerNumber),n("Immediate Cause of Death",t.cod1Text),n("Approximate Interval",t.cod1Time),n("Underlying Cause of Death",t.cod2Text),n("Approximate Interval",t.cod2Time),n("Underlying Cause of Death",t.cod3Text),n("Approximate Interval",t.cod3Time),n("Underlying Cause of Death",t.cod4Text),n("Approximate Interval",t.cod4Time),n("Other Significant Conditions Contributing to Death",t.contributing),n("Did Tobacco Use Contribute to Death?",t.tobacco),n("Pregnancy Status",t.pregnancy),n("Manner of Death",t.mannerOfDeath),n("Date of Injury",t.dateOfInjury),n("Time of Injury",t.timeOfInjury),n("Place of Injury",t.placeOfInjury),n("Injury at Work?",t.injuryAtWork),n("Location of Injury (State)",t.locationOfInjuryState),n("Location of Injury (County)",t.locationOfInjuryCounty),n("Location of Injury (City)",t.locationOfInjuryCity),n("Location of Injury (Street)",t.locationOfInjuryStreet),n("Location of Injury (Apt)",t.locationOfInjuryApt),n("Location of Injury (Zip)",t.locationOfInjuryZip),n("Describe how injury occurred",t.howInjuryOccurred)))),r.a.createElement(v.a.Row,null,r.a.createElement(v.a.Column,null,r.a.createElement(_.a,null,r.a.createElement(_.a.Group,{widths:"equal"},r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Certifier Name:"),this.input("text","certifierName")),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Certifier License Number:"),this.input("text","certifierNumber"))),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Address of Certifier")),r.a.createElement(_.a.Group,null,r.a.createElement(_.a.Field,{width:16},r.a.createElement("label",null,"Street:"),this.input("text","certifierStreet"))),r.a.createElement(_.a.Group,{widths:"equal"},r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"City:"),this.input("text","certifierCity")),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"County:"),this.input("text","certifierCounty")),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"State:"),this.input("text","certifierState")),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Zip Code:"),this.input("text","certifierZip"))),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"Bearer Token (optional):"),r.a.createElement(ce.a,{type:"text",name:"bearerToken",value:this.state.bearerToken,onChange:this.handleChange})),r.a.createElement(_.a.Field,null,r.a.createElement("label",null,"EDRS FHIR Endpoint URL:"),r.a.createElement(ce.a,{type:"text",name:"edrsEndpoint",value:this.state.edrsEndpoint,onChange:this.handleChange})),r.a.createElement($.a,{primary:!0,floated:"right",onClick:this.handleSubmit},"Submit"),r.a.createElement($.a,{primary:!0,floated:"right",onClick:function(){return console.log(JSON.stringify(bt(e.props.record,e.props.patient),null,2))}},"Log FHIR to Console"),r.a.createElement($.a,{primary:!0,floated:"right",as:"a",href:"data: text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(bt(this.props.record,this.props.patient),null,2)),download:"fhir-bundle.json"},"Download FHIR Bundle")))))}}]),t}(se),jt=function(e){function t(e){var n;Object(h.a)(this,t),n=Object(p.a)(this,Object(m.a)(t).call(this,e));var a={pronouncedDeathDate:"",pronouncedDeathTime:"",actualDeathDate:"",actualDeathTime:"",examinerContacted:null,autopsyPerformed:null,autopsyAvailable:null,placeOfDeathState:"",placeOfDeathCounty:"",placeOfDeathCity:"",placeOfDeathStreet:"",placeOfDeathApt:"",placeOfDeathZip:"",placeOfDeathName:"",placeOfDeathType:"",pronouncerName:"",pronouncerNumber:"",certifierName:"",certifierNumber:"",certifierStreet:"",certifierCity:"",certifierCounty:"",certifierState:"",certifierZip:"",certifiedDate:"",cod1Text:"",cod1Time:"",cod2Text:"",cod2Time:"",cod3Text:"",cod3Time:"",cod4Text:"",cod4Time:"",contributing:"",tobacco:null,pregnancy:null,mannerOfDeath:null,dateOfInjury:"",timeOfInjury:"",placeOfInjury:"",injuryAtWork:null,transportationInjury:null,howInjuryOccurred:"",locationOfInjuryState:"",locationOfInjuryCounty:"",locationOfInjuryCity:"",locationOfInjuryStreet:"",locationOfInjuryApt:"",locationOfInjuryZip:""};return e.smart?n.state={step:"Pronouncing",record:a,selectedConditions:[]}:e.standalone?n.state={step:"StandalonePatientSearch",record:a,selectedConditions:[]}:n.state={step:"Welcome",record:a,selectedConditions:[]},n.setPatient=n.setPatient.bind(Object(y.a)(n)),n.setUser=n.setUser.bind(Object(y.a)(n)),n.setResources=n.setResources.bind(Object(y.a)(n)),n.gotoStep=n.gotoStep.bind(Object(y.a)(n)),n.handleRecordChange=n.handleRecordChange.bind(Object(y.a)(n)),n.handleConditionClick=n.handleConditionClick.bind(Object(y.a)(n)),n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.smart&&Q().then((function(t){var n=Object(d.a)(t,6),a=n[0],r=n[1],i=n[2],o=n[3],c=n[4],l=n[5];e.setUser(a),e.setPatient(r),e.setResources(i,o,c,l)}))}},{key:"setPatient",value:function(e){this.setState({patient:e}),this.setState((function(t){var n=Object.assign({},t.record);return e.deceasedDate&&(n.actualDeathDate=e.deceasedDate),e.deceasedTime&&(n.actualDeathTime=e.deceasedTime),{record:n}}))}},{key:"setUser",value:function(e){this.setState({user:e}),this.setState((function(t){var n=Object.assign({},t.record);return n.certifierName=e.name,n.certifierStreet=e.street,n.certifierCity=e.city,n.certifierState=e.state,n.certifierZip=e.zip,{record:n}}))}},{key:"setResources",value:function(e,t,n,a){this.setState({conditions:e,medications:t,procedures:n,observations:a})}},{key:"gotoStep",value:function(e){this.setState({step:e})}},{key:"updateRecord",value:function(e,t){this.setState((function(n){var a=Object.assign({},n.record);return a[e]=t,{record:a}}))}},{key:"handleRecordChange",value:function(e,t){this.updateRecord(t.name,t.value)}},{key:"handleConditionClick",value:function(e,t){e.preventDefault();var n=this.state.conditions.find((function(e){return e.id===t.id})),a=this.state.selectedConditions.slice();a.some((function(e){return e.id===n.id}))?a=a.filter((function(e){return e.id!==n.id})):(a.push(n),a=l.a.sortBy(a,(function(e){return O()(e.startDate)})).reverse()),this.setState({selectedConditions:a});for(var r=0;r<4;r++)if(a[r]){var i=a[r].description,o=null;this.state.record.actualDeathDate&&(o=O()("".concat(this.state.record.actualDeathDate," ").concat(this.state.record.actualDeathTime))),o=o||O()().format("YYYY-MM-DD HH:mm");var c=O()(a[r].startDate).from(o,!0);this.updateRecord("cod".concat(r+1,"Text"),i),this.updateRecord("cod".concat(r+1,"Time"),c)}else this.updateRecord("cod".concat(r+1,"Text"),""),this.updateRecord("cod".concat(r+1,"Time"),"")}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},r.a.createElement(E,null),r.a.createElement(v.a,{container:!0},r.a.createElement(v.a.Row,null,r.a.createElement(w,{patient:this.state.patient})),function(t){switch(t){case"Pronouncing":return r.a.createElement(ue,{patient:e.state.patient,gotoStep:e.gotoStep,handleRecordChange:e.handleRecordChange,record:e.state.record});case"CauseOfDeath":return r.a.createElement(he,{conditions:e.state.conditions,selectedConditions:e.state.selectedConditions,medications:e.state.medications,procedures:e.state.procedures,observations:e.state.observations,gotoStep:e.gotoStep,handleRecordChange:e.handleRecordChange,handleConditionClick:e.handleConditionClick,record:e.state.record});case"AdditionalQuestions":return r.a.createElement(fe,{patient:e.state.patient,gotoStep:e.gotoStep,handleRecordChange:e.handleRecordChange,record:e.state.record});case"InjuryQuestions":return r.a.createElement(pe,{patient:e.state.patient,gotoStep:e.gotoStep,handleRecordChange:e.handleRecordChange,record:e.state.record});case"ReviewAndSubmit":return r.a.createElement(Ot,{patient:e.state.patient,gotoStep:e.gotoStep,handleRecordChange:e.handleRecordChange,record:e.state.record});case"StandalonePatientSearch":return r.a.createElement(ie,{setPatient:e.setPatient,setResources:e.setResources,gotoStep:e.gotoStep});case"Welcome":default:return r.a.createElement(re,{setPatient:e.setPatient,setResources:e.setResources,gotoStep:e.gotoStep})}}(this.state.step)))}}]),t}(a.Component),Et=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Dt(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}switch(l.a.last(window.location.pathname.split("/"))){case"launch":var Ct=(window.location.protocol+"//"+window.location.host+window.location.pathname).replace("launch","smart");G({client_id:"17eff9ba-9445-426f-a457-b49ee385464e",scope:"patient/*.read user/Patient.read openid profile online_access",redirect_uri:Ct}),o.a.render(r.a.createElement(u,null),document.getElementById("root"));break;case"smart":o.a.render(r.a.createElement(jt,{smart:!0}),document.getElementById("root"));break;case"standalone":o.a.render(r.a.createElement(jt,{standalone:!0}),document.getElementById("root"));break;default:o.a.render(r.a.createElement(jt,null),document.getElementById("root"))}!function(){if("serviceWorker"in navigator){if(new URL("/fhir-death-refactor",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/fhir-death-refactor","/service-worker.js");Et?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Dt(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):Dt(e)}))}}()}},[[229,1,2]]]);
//# sourceMappingURL=main.7e703694.chunk.js.map